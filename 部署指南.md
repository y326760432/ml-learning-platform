# ğŸš€ æœºå™¨å­¦ä¹ æ•™å­¦å¹³å° - Nginxéƒ¨ç½²æŒ‡å—

## ğŸ“¦ å·²å‡†å¤‡çš„æ–‡ä»¶

### 1. æ„å»ºäº§ç‰©
- **ä½ç½®**: `out/` ç›®å½•
- **å†…å®¹**: æ‰€æœ‰é™æ€HTMLã€JSã€CSSæ–‡ä»¶
- **å¤§å°**: çº¦ 100+ KB (gzipåæ›´å°)

### 2. Nginxé…ç½®
- **æ–‡ä»¶**: `nginx.conf`
- **ç”¨é€”**: NginxæœåŠ¡å™¨é…ç½®æ¨¡æ¿

---

## ğŸ”¨ éƒ¨ç½²æ­¥éª¤

### æ–¹æ¡ˆä¸€ï¼šLinuxæœåŠ¡å™¨éƒ¨ç½²

#### 1. ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨

```bash
# åœ¨æœ¬åœ°ï¼Œæ‰“åŒ…outç›®å½•
cd "D:\cursor-demo\éä»£ç \æœºå™¨å­¦ä¹ ç½‘ç«™"
tar -czf mllearning-dist.tar.gz out/

# ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼ˆæ›¿æ¢your-serverä¸ºå®é™…åœ°å€ï¼‰
scp mllearning-dist.tar.gz user@your-server:/tmp/
```

æˆ–è€…ä½¿ç”¨FTP/SFTPå·¥å…·ï¼ˆå¦‚FileZillaï¼‰ä¸Šä¼ æ•´ä¸ª`out`ç›®å½•ã€‚

#### 2. åœ¨æœåŠ¡å™¨ä¸Šè§£å‹

```bash
# SSHç™»å½•æœåŠ¡å™¨
ssh user@your-server

# åˆ›å»ºéƒ¨ç½²ç›®å½•
sudo mkdir -p /usr/share/nginx/html/mllearning

# è§£å‹æ–‡ä»¶
cd /tmp
tar -xzf mllearning-dist.tar.gz
sudo cp -r out/* /usr/share/nginx/html/mllearning/

# è®¾ç½®æƒé™
sudo chown -R nginx:nginx /usr/share/nginx/html/mllearning
sudo chmod -R 755 /usr/share/nginx/html/mllearning
```

#### 3. é…ç½®Nginx

```bash
# å¤åˆ¶nginxé…ç½®
sudo nano /etc/nginx/conf.d/mllearning.conf

# ç²˜è´´nginx.confçš„å†…å®¹ï¼Œå¹¶ä¿®æ”¹ï¼š
# - server_name: æ”¹æˆä½ çš„åŸŸåæˆ–IP
# - root: ç¡®è®¤è·¯å¾„æ­£ç¡®

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡è½½nginx
sudo nginx -s reload
# æˆ–
sudo systemctl reload nginx
```

#### 4. é˜²ç«å¢™è®¾ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
# CentOS/RHEL
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --reload

# Ubuntu/Debian
sudo ufw allow 'Nginx Full'
```

#### 5. è®¿é—®ç½‘ç«™

```
http://your-domain.com
http://your-domain.com/visualizations
```

---

### æ–¹æ¡ˆäºŒï¼šWindowsæœåŠ¡å™¨éƒ¨ç½²

#### 1. å®‰è£…Nginx for Windows

ä¸‹è½½ï¼šhttp://nginx.org/en/download.html

```powershell
# è§£å‹åˆ°æŸä¸ªç›®å½•ï¼Œä¾‹å¦‚ï¼š
C:\nginx\
```

#### 2. å¤åˆ¶æ–‡ä»¶

```powershell
# å¤åˆ¶outç›®å½•å†…å®¹
xcopy /E /I "D:\cursor-demo\éä»£ç \æœºå™¨å­¦ä¹ ç½‘ç«™\out" "C:\nginx\html\mllearning"
```

#### 3. é…ç½®Nginx

ç¼–è¾‘ `C:\nginx\conf\nginx.conf`ï¼Œåœ¨httpå—å†…æ·»åŠ ï¼š

```nginx
server {
    listen 80;
    server_name localhost;

    root C:/nginx/html/mllearning;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /visualizations {
        try_files $uri $uri.html /visualizations.html;
    }

    location /_next/static/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

#### 4. å¯åŠ¨Nginx

```powershell
cd C:\nginx
start nginx

# é‡è½½é…ç½®
nginx -s reload

# åœæ­¢
nginx -s stop
```

#### 5. è®¿é—®

```
http://localhost
http://localhost/visualizations
```

---

### æ–¹æ¡ˆä¸‰ï¼šä½¿ç”¨Dockeréƒ¨ç½²

#### 1. åˆ›å»ºDockerfile

åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `Dockerfile.nginx`:

```dockerfile
FROM nginx:alpine

# å¤åˆ¶æ„å»ºäº§ç‰©
COPY out/ /usr/share/nginx/html/

# å¤åˆ¶nginxé…ç½®
COPY nginx-docker.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

#### 2. åˆ›å»ºnginx-docker.conf

```nginx
server {
    listen 80;
    server_name localhost;

    root /usr/share/nginx/html;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /visualizations {
        try_files $uri $uri.html /visualizations.html;
    }

    location /_next/static/ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml text/javascript;
}
```

#### 3. æ„å»ºå’Œè¿è¡Œ

```bash
# æ„å»ºé•œåƒ
docker build -f Dockerfile.nginx -t mllearning:latest .

# è¿è¡Œå®¹å™¨
docker run -d -p 80:80 --name mllearning mllearning:latest

# æŸ¥çœ‹æ—¥å¿—
docker logs mllearning
```

---

## ğŸŒ åŸŸåå’ŒHTTPSé…ç½®

### ä½¿ç”¨Let's Encryptï¼ˆå…è´¹SSLè¯ä¹¦ï¼‰

```bash
# å®‰è£…certbot
sudo apt install certbot python3-certbot-nginx  # Ubuntu/Debian
sudo yum install certbot python3-certbot-nginx  # CentOS

# è·å–è¯ä¹¦å¹¶è‡ªåŠ¨é…ç½®nginx
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

é…ç½®ånginxä¼šè‡ªåŠ¨æ›´æ–°ä¸ºï¼š

```nginx
server {
    listen 443 ssl;
    server_name your-domain.com;
    
    ssl_certificate /etc/letsencrypt/live/your-domain.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/your-domain.com/privkey.pem;
    
    # ... å…¶ä»–é…ç½®
}

server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}
```

---

## ğŸ“Š éªŒè¯éƒ¨ç½²

### 1. æ£€æŸ¥æ–‡ä»¶

```bash
# ç¡®è®¤æ–‡ä»¶å­˜åœ¨
ls -la /usr/share/nginx/html/mllearning/
ls -la /usr/share/nginx/html/mllearning/_next/

# åº”è¯¥çœ‹åˆ°ï¼š
# index.html
# visualizations.html
# 404.html
# _next/ ç›®å½•
```

### 2. æ£€æŸ¥NginxçŠ¶æ€

```bash
# Linux
sudo systemctl status nginx
sudo nginx -t

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
sudo tail -f /var/log/nginx/error.log
```

### 3. æµ‹è¯•é¡µé¢

```bash
# æµ‹è¯•ä¸»é¡µ
curl http://your-domain.com

# æµ‹è¯•å¯è§†åŒ–é¡µé¢
curl http://your-domain.com/visualizations

# æµ‹è¯•404
curl http://your-domain.com/nonexistent
```

### 4. æµè§ˆå™¨æµ‹è¯•

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- âœ… http://your-domain.com - ä¸»é¡µ
- âœ… http://your-domain.com/visualizations - å¯è§†åŒ–é¡µé¢
- âœ… æµ‹è¯•æ‰€æœ‰7ä¸ªç®—æ³•
- âœ… æ£€æŸ¥Consoleæ— é”™è¯¯

---

## ğŸ”§ å¸¸è§é—®é¢˜

### é—®é¢˜1: 404é”™è¯¯

**åŸå› **: Nginxæ‰¾ä¸åˆ°æ–‡ä»¶

**è§£å†³**:
```bash
# æ£€æŸ¥æ–‡ä»¶è·¯å¾„
sudo ls -la /usr/share/nginx/html/mllearning/

# æ£€æŸ¥nginxé…ç½®ä¸­çš„rootè·¯å¾„
sudo nginx -T | grep root
```

### é—®é¢˜2: 403 Forbidden

**åŸå› **: æƒé™é—®é¢˜

**è§£å†³**:
```bash
# è®¾ç½®æ­£ç¡®çš„æ‰€æœ‰è€…
sudo chown -R nginx:nginx /usr/share/nginx/html/mllearning/

# è®¾ç½®æ­£ç¡®çš„æƒé™
sudo chmod -R 755 /usr/share/nginx/html/mllearning/
```

### é—®é¢˜3: CSS/JSåŠ è½½å¤±è´¥

**åŸå› **: è·¯å¾„é—®é¢˜

**è§£å†³**:
- æ£€æŸ¥æµè§ˆå™¨Console
- ç¡®ä¿ `_next/static/` ç›®å½•å­˜åœ¨
- æ£€æŸ¥nginx access.logçœ‹å®é™…è¯·æ±‚è·¯å¾„

### é—®é¢˜4: é¡µé¢åˆ·æ–°å404

**åŸå› **: Nginxæ²¡æœ‰é…ç½®SPAè·¯ç”±

**è§£å†³**: ç¡®ä¿nginx.confä¸­æœ‰ï¼š
```nginx
location / {
    try_files $uri $uri/ /index.html;
}
```

---

## ğŸ¯ æ€§èƒ½ä¼˜åŒ–

### 1. å¯ç”¨Gzipå‹ç¼©

å·²åœ¨nginx.confä¸­é…ç½®ï¼Œç¡®ä¿å¼€å¯ï¼š
```nginx
gzip on;
gzip_types text/plain text/css application/json application/javascript;
```

### 2. è®¾ç½®ç¼“å­˜

é™æ€èµ„æºå·²è®¾ç½®1å¹´ç¼“å­˜ï¼š
```nginx
location /_next/static/ {
    expires 1y;
    add_header Cache-Control "public, immutable";
}
```

### 3. ä½¿ç”¨CDNï¼ˆå¯é€‰ï¼‰

å°† `_next/static/` ç›®å½•ä¸Šä¼ åˆ°CDNï¼Œä¿®æ”¹HTMLä¸­çš„è·¯å¾„ã€‚

---

## ğŸ“ æ–‡ä»¶æ¸…å•

```
é¡¹ç›®æ ¹ç›®å½•/
â”œâ”€â”€ out/                      # æ„å»ºäº§ç‰©ï¼ˆä¸Šä¼ è¿™ä¸ªï¼‰
â”‚   â”œâ”€â”€ _next/                # Next.jsèµ„æº
â”‚   â”‚   â””â”€â”€ static/           # é™æ€æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html            # ä¸»é¡µ
â”‚   â”œâ”€â”€ visualizations.html   # å¯è§†åŒ–é¡µé¢
â”‚   â””â”€â”€ 404.html              # 404é¡µé¢
â”œâ”€â”€ nginx.conf                # Nginxé…ç½®æ¨¡æ¿
â””â”€â”€ éƒ¨ç½²æŒ‡å—.md               # æœ¬æ–‡ä»¶
```

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²å‘½ä»¤

```bash
# 1. åœ¨æœ¬åœ°æ‰“åŒ…
cd "D:\cursor-demo\éä»£ç \æœºå™¨å­¦ä¹ ç½‘ç«™"
tar -czf mllearning-dist.tar.gz out/

# 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp mllearning-dist.tar.gz user@your-server:/tmp/

# 3. åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
ssh user@your-server
cd /tmp
tar -xzf mllearning-dist.tar.gz
sudo mkdir -p /usr/share/nginx/html/mllearning
sudo cp -r out/* /usr/share/nginx/html/mllearning/
sudo chown -R nginx:nginx /usr/share/nginx/html/mllearning

# 4. é…ç½®nginxï¼ˆå¤åˆ¶nginx.confå†…å®¹ï¼‰
sudo nano /etc/nginx/conf.d/mllearning.conf

# 5. é‡è½½nginx
sudo nginx -t && sudo nginx -s reload
```

---

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] æ–‡ä»¶å·²ä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] Nginxé…ç½®æ­£ç¡®
- [ ] æ–‡ä»¶æƒé™æ­£ç¡®ï¼ˆ755ï¼‰
- [ ] Nginxå·²é‡è½½
- [ ] é˜²ç«å¢™å·²å¼€æ”¾80ç«¯å£
- [ ] ä¸»é¡µå¯ä»¥è®¿é—®
- [ ] å¯è§†åŒ–é¡µé¢å¯ä»¥è®¿é—®
- [ ] æ‰€æœ‰7ä¸ªç®—æ³•æ­£å¸¸å·¥ä½œ
- [ ] Consoleæ— é”™è¯¯
- [ ] æ€§èƒ½æ­£å¸¸ï¼ˆåŠ è½½å¿«ï¼‰

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼š
1. æ£€æŸ¥Nginxé”™è¯¯æ—¥å¿—ï¼š`sudo tail -f /var/log/nginx/error.log`
2. æ£€æŸ¥æµè§ˆå™¨Console
3. éªŒè¯æ–‡ä»¶å®Œæ•´æ€§
4. æµ‹è¯•nginxé…ç½®ï¼š`sudo nginx -t`

---

**éƒ¨ç½²å®Œæˆåï¼Œä½ çš„æœºå™¨å­¦ä¹ å¯è§†åŒ–å¹³å°å°±å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡äº†ï¼** ğŸ‰

è®¿é—®åœ°å€ï¼š
- ä¸»é¡µï¼šhttp://your-domain.com
- å¯è§†åŒ–ï¼šhttp://your-domain.com/visualizations

