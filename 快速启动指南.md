# 机器学习教学平台 - 快速启动指南

## 📋 前置要求

### 必需软件
- **Node.js**: v18.0.0 或更高版本
- **npm**: v9.0.0 或更高版本（或 pnpm v8.0.0+）
- **PostgreSQL**: v15.0 或更高版本
- **Redis**: v7.0 或更高版本
- **Docker**: v24.0 或更高版本（用于代码执行环境）
- **Git**: v2.30 或更高版本

### 推荐工具
- **VS Code**: 推荐的代码编辑器
- **Postman** 或 **Insomnia**: API测试工具
- **TablePlus** 或 **DBeaver**: 数据库管理工具

---

## 🚀 快速开始

### 1. 克隆仓库

```bash
# 克隆项目（假设已创建仓库）
git clone https://github.com/your-org/mllearning-platform.git
cd mllearning-platform
```

### 2. 项目初始化

#### 创建项目结构

```bash
# 创建主目录
mkdir mllearning-platform
cd mllearning-platform

# 创建前后端子目录
mkdir frontend backend
```

#### 初始化前端项目

```bash
cd frontend

# 使用Next.js创建项目
npx create-next-app@latest . --typescript --tailwind --app --yes

# 安装必要依赖
npm install @radix-ui/react-dialog @radix-ui/react-dropdown-menu
npm install framer-motion zustand @tanstack/react-query
npm install axios
npm install d3 @types/d3
npm install plotly.js react-plotly.js
npm install @monaco-editor/react
npm install katex react-katex
npm install react-markdown remark-gfm rehype-katex
npm install prismjs @types/prismjs

# 开发依赖
npm install -D @types/react @types/node
npm install -D eslint prettier eslint-config-prettier
npm install -D @testing-library/react @testing-library/jest-dom
npm install -D jest jest-environment-jsdom
```

#### 初始化后端项目

```bash
cd ../backend

# 初始化Node.js项目
npm init -y

# 安装核心依赖
npm install express cors dotenv
npm install pg redis
npm install jsonwebtoken bcrypt
npm install passport passport-google-oauth20 passport-github2
npm install joi
npm install winston
npm install multer

# 安装TypeScript相关
npm install -D typescript @types/node @types/express
npm install -D @types/cors @types/bcrypt @types/jsonwebtoken
npm install -D nodemon ts-node

# 开发和测试工具
npm install -D jest @types/jest ts-jest
npm install -D supertest @types/supertest
npm install -D eslint @typescript-eslint/parser @typescript-eslint/eslint-plugin
npm install -D prettier

# 初始化TypeScript配置
npx tsc --init
```

### 3. 环境配置

#### 前端环境变量

创建 `frontend/.env.local`:

```bash
# API配置
NEXT_PUBLIC_API_URL=http://localhost:3001/api
NEXT_PUBLIC_WS_URL=ws://localhost:3001

# 认证配置
NEXT_PUBLIC_GOOGLE_CLIENT_ID=your_google_client_id
NEXT_PUBLIC_GITHUB_CLIENT_ID=your_github_client_id

# 其他配置
NEXT_PUBLIC_APP_NAME=MLearning
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

#### 后端环境变量

创建 `backend/.env`:

```bash
# 服务器配置
NODE_ENV=development
PORT=3001
API_PREFIX=/api

# 数据库配置
DATABASE_URL=postgresql://postgres:password@localhost:5432/mllearning
DB_HOST=localhost
DB_PORT=5432
DB_NAME=mllearning
DB_USER=postgres
DB_PASSWORD=password

# Redis配置
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379

# JWT配置
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_EXPIRES_IN=15m
REFRESH_TOKEN_SECRET=your-refresh-token-secret
REFRESH_TOKEN_EXPIRES_IN=7d

# OAuth配置
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret
GOOGLE_CALLBACK_URL=http://localhost:3001/api/auth/google/callback

GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_CALLBACK_URL=http://localhost:3001/api/auth/github/callback

# 文件上传
UPLOAD_DIR=./uploads
MAX_FILE_SIZE=5242880  # 5MB

# 代码执行
DOCKER_IMAGE=mllearning-python-sandbox
CODE_EXECUTION_TIMEOUT=5000  # 5秒
CODE_EXECUTION_MEMORY_LIMIT=134217728  # 128MB

# CORS
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001

# 日志
LOG_LEVEL=debug
LOG_DIR=./logs
```

### 4. 数据库设置

#### 创建数据库

```bash
# 连接PostgreSQL
psql -U postgres

# 创建数据库
CREATE DATABASE mllearning;

# 退出
\q
```

#### 运行迁移

创建 `backend/src/database/schema.sql`:

```sql
-- 见技术架构文档中的数据库设计部分
-- 复制完整的SQL schema
```

执行迁移:

```bash
psql -U postgres -d mllearning -f src/database/schema.sql
```

### 5. Docker配置（代码执行环境）

创建 `backend/docker/python-sandbox/Dockerfile`:

```dockerfile
FROM python:3.11-slim

# 安装必要的库
RUN pip install --no-cache-dir \
    numpy==1.24.0 \
    pandas==2.0.0 \
    scikit-learn==1.3.0 \
    matplotlib==3.7.0 \
    seaborn==0.12.0

# 创建非root用户
RUN useradd -m -u 1000 sandbox && \
    mkdir -p /app && \
    chown -R sandbox:sandbox /app

USER sandbox
WORKDIR /app

CMD ["python"]
```

构建Docker镜像:

```bash
cd backend/docker/python-sandbox
docker build -t mllearning-python-sandbox .
```

### 6. 启动服务

#### 启动Redis

```bash
# MacOS (使用Homebrew)
brew services start redis

# Linux
sudo systemctl start redis

# 或使用Docker
docker run -d -p 6379:6379 redis:7-alpine
```

#### 启动后端服务

```bash
cd backend

# 开发模式
npm run dev

# 或
nodemon src/index.ts
```

#### 启动前端服务

```bash
cd frontend

# 开发模式
npm run dev
```

### 7. 验证安装

访问以下地址验证：

- 前端: http://localhost:3000
- 后端API: http://localhost:3001/api
- 健康检查: http://localhost:3001/api/health

---

## 📁 项目结构

### 完整目录结构

```
mllearning-platform/
├── frontend/                   # 前端项目
│   ├── src/
│   │   ├── app/               # Next.js App Router
│   │   │   ├── (auth)/
│   │   │   ├── (dashboard)/
│   │   │   ├── api/
│   │   │   ├── layout.tsx
│   │   │   └── page.tsx
│   │   ├── components/        # 组件
│   │   ├── hooks/            # 自定义Hooks
│   │   ├── lib/              # 工具库
│   │   ├── stores/           # 状态管理
│   │   ├── types/            # 类型定义
│   │   └── styles/           # 样式
│   ├── public/               # 静态资源
│   ├── tests/                # 测试
│   ├── .env.local            # 环境变量
│   ├── next.config.js
│   ├── tailwind.config.js
│   ├── tsconfig.json
│   └── package.json
│
├── backend/                   # 后端项目
│   ├── src/
│   │   ├── api/              # API层
│   │   ├── services/         # 业务逻辑
│   │   ├── models/           # 数据模型
│   │   ├── database/         # 数据库
│   │   ├── utils/            # 工具函数
│   │   ├── config/           # 配置
│   │   └── index.ts          # 入口文件
│   ├── docker/               # Docker配置
│   ├── tests/                # 测试
│   ├── logs/                 # 日志
│   ├── uploads/              # 上传文件
│   ├── .env                  # 环境变量
│   ├── tsconfig.json
│   └── package.json
│
├── docs/                      # 文档
│   ├── PRD-机器学习教学平台.md
│   ├── 开发计划.md
│   ├── 技术架构设计.md
│   └── UI设计规范.md
│
├── .gitignore
├── README.md
└── docker-compose.yml         # Docker编排
```

---

## 🔧 关键配置文件

### TypeScript配置

#### frontend/tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["next-env.d.ts", "**/*.ts", "**/*.tsx", ".next/types/**/*.ts"],
  "exclude": ["node_modules"]
}
```

#### backend/tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "commonjs",
    "lib": ["ES2020"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "resolveJsonModule": true,
    "moduleResolution": "node",
    "types": ["node", "jest"],
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    }
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "tests"]
}
```

### Tailwind CSS配置

#### frontend/tailwind.config.js

```javascript
/** @type {import('tailwindcss').Config} */
module.exports = {
  content: [
    './src/pages/**/*.{js,ts,jsx,tsx,mdx}',
    './src/components/**/*.{js,ts,jsx,tsx,mdx}',
    './src/app/**/*.{js,ts,jsx,tsx,mdx}',
  ],
  theme: {
    extend: {
      colors: {
        primary: {
          50: '#EFF6FF',
          100: '#DBEAFE',
          200: '#BFDBFE',
          300: '#93C5FD',
          400: '#60A5FA',
          500: '#3B82F6',
          600: '#2563EB',
          700: '#1D4ED8',
          800: '#1E40AF',
          900: '#1E3A8A',
        },
        secondary: {
          50: '#FAF5FF',
          100: '#F3E8FF',
          200: '#E9D5FF',
          300: '#D8B4FE',
          400: '#C084FC',
          500: '#A855F7',
          600: '#9333EA',
          700: '#7E22CE',
          800: '#6B21A8',
          900: '#581C87',
        },
      },
      fontFamily: {
        sans: [
          '-apple-system',
          'BlinkMacSystemFont',
          'Segoe UI',
          'PingFang SC',
          'Hiragino Sans GB',
          'Microsoft YaHei',
          'sans-serif',
        ],
        mono: [
          'Fira Code',
          'JetBrains Mono',
          'Consolas',
          'Monaco',
          'monospace',
        ],
      },
      animation: {
        'fade-in': 'fadeIn 0.3s ease-in-out',
        'slide-up': 'slideUp 0.3s ease-out',
        'spin-slow': 'spin 3s linear infinite',
      },
      keyframes: {
        fadeIn: {
          '0%': { opacity: '0' },
          '100%': { opacity: '1' },
        },
        slideUp: {
          '0%': { transform: 'translateY(20px)', opacity: '0' },
          '100%': { transform: 'translateY(0)', opacity: '1' },
        },
      },
    },
  },
  plugins: [],
}
```

### Next.js配置

#### frontend/next.config.js

```javascript
/** @type {import('next').NextConfig} */
const nextConfig = {
  reactStrictMode: true,
  swcMinify: true,
  
  // 图片优化
  images: {
    domains: ['localhost', 'your-cdn-domain.com'],
    formats: ['image/avif', 'image/webp'],
  },
  
  // 环境变量
  env: {
    NEXT_PUBLIC_API_URL: process.env.NEXT_PUBLIC_API_URL,
  },
  
  // 国际化（未来扩展）
  i18n: {
    locales: ['zh-CN', 'en-US'],
    defaultLocale: 'zh-CN',
  },
  
  // 性能优化
  compiler: {
    removeConsole: process.env.NODE_ENV === 'production',
  },
  
  // 实验性功能
  experimental: {
    serverActions: true,
  },
}

module.exports = nextConfig
```

### ESLint配置

#### .eslintrc.json

```json
{
  "extends": [
    "next/core-web-vitals",
    "eslint:recommended",
    "plugin:@typescript-eslint/recommended",
    "prettier"
  ],
  "parser": "@typescript-eslint/parser",
  "plugins": ["@typescript-eslint"],
  "rules": {
    "@typescript-eslint/no-unused-vars": "warn",
    "@typescript-eslint/no-explicit-any": "warn",
    "no-console": "warn"
  }
}
```

### Prettier配置

#### .prettierrc

```json
{
  "semi": false,
  "singleQuote": true,
  "tabWidth": 2,
  "trailingComma": "es5",
  "printWidth": 80,
  "arrowParens": "always"
}
```

### Docker Compose

#### docker-compose.yml

```yaml
version: '3.8'

services:
  # PostgreSQL数据库
  postgres:
    image: postgres:15-alpine
    container_name: mllearning-postgres
    environment:
      POSTGRES_DB: mllearning
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: password
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
    restart: unless-stopped

  # Redis缓存
  redis:
    image: redis:7-alpine
    container_name: mllearning-redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    restart: unless-stopped

  # 后端API（可选，用于生产环境）
  # api:
  #   build:
  #     context: ./backend
  #     dockerfile: Dockerfile
  #   container_name: mllearning-api
  #   ports:
  #     - "3001:3001"
  #   environment:
  #     - NODE_ENV=production
  #     - DATABASE_URL=postgresql://postgres:password@postgres:5432/mllearning
  #     - REDIS_URL=redis://redis:6379
  #   depends_on:
  #     - postgres
  #     - redis
  #   restart: unless-stopped

volumes:
  postgres_data:
  redis_data:
```

---

## 🧪 测试

### 运行测试

```bash
# 前端测试
cd frontend
npm run test

# 后端测试
cd backend
npm run test

# 测试覆盖率
npm run test:coverage
```

### 编写测试示例

```typescript
// frontend/tests/components/Button.test.tsx
import { render, screen, fireEvent } from '@testing-library/react'
import { Button } from '@/components/ui/Button'

describe('Button组件', () => {
  it('应该正确渲染', () => {
    render(<Button>点击我</Button>)
    expect(screen.getByText('点击我')).toBeInTheDocument()
  })
  
  it('点击时应该触发回调', () => {
    const handleClick = jest.fn()
    render(<Button onClick={handleClick}>点击我</Button>)
    
    fireEvent.click(screen.getByText('点击我'))
    expect(handleClick).toHaveBeenCalledTimes(1)
  })
})
```

---

## 🐛 常见问题

### 1. 端口被占用

```bash
# 查找占用端口的进程
lsof -i :3000
lsof -i :3001

# 终止进程
kill -9 <PID>
```

### 2. 数据库连接失败

- 检查PostgreSQL是否运行
- 验证.env中的数据库配置
- 确保数据库已创建

### 3. Redis连接失败

```bash
# 检查Redis状态
redis-cli ping
# 应返回 PONG
```

### 4. Docker镜像构建失败

```bash
# 清理Docker缓存
docker system prune -a

# 重新构建
docker build -t mllearning-python-sandbox .
```

---

## 📚 下一步

1. **阅读PRD文档**: 了解产品需求
2. **查看技术架构**: 理解系统设计
3. **参考UI设计规范**: 开始开发界面
4. **按照开发计划**: 逐步实现功能

---

## 🤝 团队协作

### Git工作流

```bash
# 创建功能分支
git checkout -b feature/user-auth

# 提交代码
git add .
git commit -m "feat: 实现用户登录功能"

# 推送到远程
git push origin feature/user-auth

# 创建Pull Request进行代码审查
```

### Commit规范

```
feat: 新功能
fix: Bug修复
docs: 文档更新
style: 代码格式调整
refactor: 代码重构
test: 测试相关
chore: 构建/工具链更新
```

---

## 📞 获取帮助

- **技术问题**: 查看文档或在团队群提问
- **Bug报告**: 在GitHub Issues中创建
- **功能建议**: 通过Discord讨论

---

**祝开发顺利！** 🚀




